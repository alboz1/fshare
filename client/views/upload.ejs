<!DOCTYPE html>
<html lang="en">
<%- include('partials/head.ejs') %>
<body>
    <main>
        <%- include('partials/header.ejs') %>
        <% if (error) { %>
            <div class="error-container">
                <p class="error-message"><%= error %></p>
                <a href="/" class="btn" title="Homepage">Go back</a>
            </div>
        <% } else { %>
            <div class="container space-between">
                <section class="file-section">
                    <figure>
                        <% if (file.isImage) { %>
                            <img src="<%= file.downloadURL %>" alt="picture" class="img" />
                        <% } else { %>
                            <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="100px" height="100px"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M0 64C0 28.65 28.65 0 64 0H224V128C224 145.7 238.3 160 256 160H384V448C384 483.3 355.3 512 320 512H64C28.65 512 0 483.3 0 448V64zM256 128V0L384 128H256z"/></svg>
                        <% } %>
                        <figcaption><%= file.name %></figcaption>
                    </figure>
                </section>
                <section class="share-section">
                    <div class="url">
                        <h5 class="small">Share URL</h5>
                        <div class="share-url-wrapper">
                            <p id="share-url"><%= file.shareURL %></p>
                            <button class="copy-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20px" height="20px"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M384 96L384 0h-112c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48H464c26.51 0 48-21.49 48-48V128h-95.1C398.4 128 384 113.6 384 96zM416 0v96h96L416 0zM192 352V128h-144c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h192c26.51 0 48-21.49 48-48L288 416h-32C220.7 416 192 387.3 192 352z"/></svg>
                            </button>
                        </div>
                    </div>
                    <span class="horizontal-line">OR</span>
                    <div class="qr-code-share">
                        <p>Scan QR code to download</p>
                        <div class="qr-code"></div>
                    </div>
                </section>
            </div>
        <% } %>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
        const shareURL = document.querySelector('#share-url');
        const qrContainer = document.querySelector('.qr-code');

        shareURL && new QRCode(qrContainer, {
            text: shareURL.textContent,
            width: 200,
            height: 200,
            colorDark: '#283237'
        });

        const copyBtn = document.querySelector('.copy-btn');
        copyBtn && copyBtn.addEventListener('click', e => {
            const copyText = document.querySelector('#share-url');
            navigator.clipboard.writeText(copyText.textContent);
        });
    </script>
</body>
</html>